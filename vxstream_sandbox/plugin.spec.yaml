plugin_spec_version: v2
extension: plugin
product: ["insightconnect"]
name: vxstream_sandbox
title: VxStream Sandbox
vendor: rapid7
support: community
status: []
description: VxStream Malware Analysis Service
version: 2.0.0
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/vxstream_sandbox
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
tags:
      type: '[]string'
      required: false
    sha256:
      title: SHA256 Hash
      type: string
      required: false
    environmentId:
      title: Environment ID
      type: string
      required: false
    submitname:
      title: Filename
      description: File name
      type: string
      required: false
    environmentDescription:
      title: Environment Description
      type: string
      required: false
    size:
      title: Filesize (Bytes)
      type: integer
      required: false
    type:
      type: string
      description: File type
      required: false
    targeturl:
      type: string
      required: false
    md5:
      title: MD5 Hash
      type: string
      required: false
    sha1:
      title: SHA1 Hash
      type: string
      required: false
    isurlanalysis:
      title: URL Analysis?
      type: boolean
      required: false
    isinteresting:
      title: Interesting?
      type: boolean
      required: false
    analysis_start_time:
      title: Analysis StartTime
      type: date
      required: false
    total_signatures:
      type: integer
      required: false
    total_processes:
      type: integer
      required: false
    total_network_connections:
      type: integer
      required: false
    threatscore:
      description: Confidence value of VxStream Sandbox in the verdict; lies between
        0 and 100
      type: integer
      required: false
    threatlevel:
      description: Threat Level
      type: integer
      required: false
    domains:
      type: '[]string'
      required: false
    hosts:
      type: '[]string'
      required: false
    verdict:
      description: File verdict e.g. malicious
      type: string
      required: false
    vxfamily:
      description: VxFamily e.g. Trojan.Generic
      type: string
      required: false
    avdetect:
      description: AV MultiScan Detection Percentage
      type: string
      required: false
connection:
  server:
    type: string
    description: VxStream Sandbox API Server URL
    required: true
    default: https://www.hybrid-analysis.com/api
  api_key:
    title: API Key
    type: credential_secret_key
    description: API key
    required: true
  api_secret:
    title: API Secret
    type: credential_secret_key
    description: API secret
    required: true
actions:
  submit:
    title: Submit File
    description: Submit file for analysis
    input:
      file:
        description: File to be analyzed. See https://vxstream-sandbox.com/faq for
          supported filetypes
        type: bytes
        required: true
      filename:
        type: string
        description: Optional filename of the malware
        required: false
      promptfill_password:
        title: Password
        description: Optional malware password to pass in to the analysis (shortcut
          for /VX:promptfill)
        type: string
        required: false
      customcmdline:
        title: Custom Command Line
        description: Custom Command Line, e.g. /VX:promptfill mypassword
        type: string
        required: false
      env_id:
        title: Environment ID
        description: Environment ID
        type: integer
        default: 100
        required: false
      scriptlogging:
        type: boolean
        title: Enable Script Logging
        default: true
        description: Enable the script logging feature. This feature can give deeper
          insights into the functionality of Javascripts, VBA macros and similar script
          languages (see 'Script calls' in the per process details)
        required: false
      hybridanalysis:
        title: Enable Hybrid Analysis
        description: Enable a unique process memory inspection. This feature may slow
          down the overall analysis, but improves behavior analysis through instruction
          level inspection regardless of execution
        type: boolean
        default: true
        required: false
      experimentalantievasion:
        title: Enable Experimental Anti Evasion Techniques
        description: Enable experimental anti-evasion features. This feature can have
          an impact application execution, but at the same time can improve performance
          for very evasive malware
        type: boolean
        default: true
        required: false
    output:
      submission_url:
        type: string
        required: false
        description: Submission URL
      response_code:
        description: Response code
        type: integer
        required: true
      hash:
        description: SHA256 Hash
        type: string
        required: false
  lookup:
    title: Lookup by Hash
    description: Get summary information for a given hash
    input:
      hash:
        description: MD5/SHA1/SHA256 hash
        type: string
        required: true
    output:
      response_code:
        description: Response code
        type: integer
        required: true
      reports:
        title: Reports
        description: Reports
        type: '[]report'
        required: false
      count:
        title: Count
        description: Number of reports returned
        type: integer
        required: false
  query:
    title: Search Database
    description: Search the database using query syntax provided at https://www.hybrid-analysis.com/faq
    input:
      query:
        description: Search parameters; syntax available at https://www.hybrid-analysis.com/faq
        type: string
        required: false
    output:
      response_code:
        description: Response code
        type: integer
        required: true
      count:
        title: Count
        description: Number of results returned
        type: integer
        required: false
      query:
        description: Query
        type: string
        required: false
      results:
        title: Results List
        description: List of results
        type: '[]result'
        required: false
  report:
    title: Retrieve Report
    description: Retrieve report by providing SHA256 hash
    input:
      hash:
        description: SHA256 Hash
        type: string
        required: false
      env_id:
        title: Environment ID
        description: Environment ID
        type: string
        required: false
    output:
      found:
        title: Found
        type: boolean
        description: True if found
        required: false
      response_code:
        title: Response code
        description: Response code
        type: integer
        required: false
      state:
        title: Analysis State
        description: State
        type: string
        required: false
      analysis:
        title: Analysis
        type: analysis
        description: Analysis
        required: false
