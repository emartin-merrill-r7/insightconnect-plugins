plugin_spec_version: v2
extension: plugin
product: ["insightconnect"]
name: vmray
title: VMRay Sandbox
description: VMRay allows you to analyze and detect malware before it lands
version: 4.0.1
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/vmray
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
tags:
      description: Submission tags
      title: Submission Tags
      type: '[]object'
    submission_type:
      description: Submission type
      title: Submission Type
      type: string
    submission_user_account_id:
      description: Submission user account ID
      title: Submission User Account ID
      type: integer
    submission_user_account_name:
      description: Submission user account name
      title: Submission User Account Name
      type: string
    submission_user_account_subscription_mode:
      description: Submission user account subscription mode
      title: Submission User Account Subscription Mode
      type: string
    submission_user_email:
      description: Submission user email
      title: Submission User Email
      type: string
    submission_user_id:
      description: Submission user ID
      title: Submission User ID
      type: integer
    submission_webif_url:
      description: Submission webif URL
      title: Submission Webif URL
      type: string
    submission_whois_mode:
      description: Submission WHOIS mode
      title: Submission WHOIS Mode
      type: string
  samples_files:
    sample_created:
      description: Sample created
      title: Sample Created
      type: string
    sample_filename:
      description: Sample filename
      title: Sample Filename
      type: string
    sample_filesize:
      description: Sample filesize
      title: Sample Filesize
      type: integer
    sample_id:
      description: Sample ID
      title: Sample ID
      type: integer
    sample_is_multipart:
      description: Sample is multipart
      title: Sample Is Multipart
      type: boolean
    sample_md5hash:
      description: Sample MD5 hash
      title: Sample MD5 Hash
      type: string
    sample_priority:
      description: Sample priority
      title: Sample Priority
      type: integer
    sample_sha1hash:
      description: Sample SHA1 hash
      title: Sample SHA1 Hash
      type: string
    sample_sha256hash:
      description: Sample SHA256 hash
      title: Sample SHA256 Hash
      type: string
    sample_ssdeephash:
      description: Sample ssdeep hash
      title: Sample ssdeep hash
      type: string
    sample_type:
      description: Sample type
      title: Sample Type
      type: string
    sample_webif_url:
      description: Sample webif URL
      title: Sample Webif URL
      type: string
    submission_filename:
      description: Submission filename
      title: Submission Filename
      type: string
  submit_file:
    md_jobs:
      description: MD jobs
      title: MD Jobs
      type: '[]object'
    errors:
      description: Errors
      title: Errors
      type: '[]object'
    jobs:
      description: Jobs
      title: Jobs
      type: '[]object'
    vt_jobs:
      description: VT jobs
      title: VT Jobs
      type: '[]object'
    whois_jobs:
      description: WHOIS jobs
      title: WHOIS Jobs
      type: '[]object'
    reputation_jobs:
      description: Reputation jobs
      title: Reputation Jobs
      type: '[]reputation_jobs'
    samples:
      description: Samples
      title: Samples
      type: '[]samples_files'
    static_jobs:
      description: Static jobs
      title: Static Jobs
      type: '[]object'
    submissions:
      description: Submissions
      title: Submissions
      type: '[]submissions_file'
connection:
  api_key:
    type: credential_secret_key
    description: API key for VMRay
    required: true
    title: API Key
  url:
    title: VMRay URL
    description: VMRay host e.g https://cloud.vmray.com
    type: string
    default: https://cloud.vmray.com
    required: true
actions:
  submit_file:
    title: Submit File
    description: Submit file for analysis
    input:
      file:
        type: file
        required: true
        description: File and filename for analysis
        title: File
      analyzer_mode:
        type: string
        required: false
        description: Specify what analyzer mode to use
        enum:
          - default
          - reputation
          - reputation_static
          - reputation_static_dynamic
          - static_dynamic
          - static
        default: "default"
      optional_params:
        title: Optional Parameters
        description: 'Parameters that allow finer tuning of the Submit File action,
          e.g {"analysis_id": 12345}'
        type: object
        required: false
    output:
      results:
        title: Results
        description: Results returned from submitting a URL
        type: submit_file
        required: false
  submit_url:
    title: Submit URL
    description: Submits a URL for analysis
    input:
      url:
        title: URL
        description: URL to be submitted for analysis
        type: string
        required: true
      analyzer_mode:
        type: string
        required: false
        description: Specify what analyzer mode to use
        enum:
        - default
        - reputation
        - reputation_static
        - reputation_static_dynamic
        - static_dynamic
        - static
        default: "default"
      optional_params:
        title: Optional Parameters
        description: 'Parameters that allow finer tuning of the Submit URL action,
          e.g {"analysis_id": 12345}'
        type: object
        required: false
    output:
      results:
        title: Results
        description: Results returned from submitting a URL
        type: submit_url
        required: false
  get_analysis:
    title: Get Analysis
    description: Get all dynamic and static analyses in the system or details about
      specific ones
    input:
      id_type:
        title: ID Type
        description: Get analysis based on ID of a specified type
        type: string
        enum:
        - analysis_id
        - analyzer
        - configuration
        - static_config
        - created
        - job
        - jobrule
        - job_started
        - prescript
        - result_code
        - sample
        - size
        - snapshot
        - submission
        - user
        - vm
        - vmhost
        - vti_score
        - all
        required: true
      id:
        title: ID
        description: ID based on ID type selected, leave blank if 'all' is selected
        type: string
        required: false
      optional_params:
        title: Optional Parameters
        description: 'Parameters that allow finer tuning of the Get Analysis action,
          e.g {"analysis_id": 12345}'
        type: object
        required: false
    output:
      results:
        title: Results
        description: Results returned from analysis
        type: '[]analysis_result'
        required: false
  get_samples:
    title: Get Samples
    description: Get all samples in the system or details about specific ones. You
      can also search by hashes
    input:
      sample_type:
        title: Sample Type
        description: Specified type of sample
        type: string
        enum:
        - all
        - sample_id
        - created
        - filesize
        - md5
        - sha1
        - sha256
        - type
        required: true
      sample:
        title: Sample
        description: Sample ID, hash or type, leave blank if 'all' is selected
        type: string
        required: false
      optional_params:
        title: Optional Parameters
        description: 'Parameters that allow finer tuning of the Get Samples action,
          e.g {"analysis_id": 12345}'
        type: object
        required: false
    output:
      results:
        title: Results
        description: Results from samples
        type: '[]sample'
        required: false
