plugin_spec_version: v2
extension: plugin
product: ["insightconnect"]
name: rapid7_insightvm
title: Rapid7 InsightVM
description: InsightVM is a powerful vulnerability management tool which finds, prioritizes,
  and remediates vulnerabilities
version: 3.5.0
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/rapid7_insightvm
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
tags:
        title: Tags
        description: List of tags
        type: '[]tag'
        required: true
  get_sites:
    title: Get Sites
    description: Get a list of sites
    input:
      name:
        title: Name
        description: Site name regular expression by which to filter
        type: string
        default: ''
        required: false
    output:
      sites:
        title: Sites
        description: List of sites
        type: '[]site'
        required: true
  get_site:
    title: Get Site
    description: Get a site by ID
    input:
      id:
        title: ID
        description: Site ID
        type: integer
        required: true
    output:
      site:
        title: Site
        description: Site details
        type: site
        required: true
  create_site:
    title: Create Site
    description: Create a new site
    input:
      name:
        title: Name
        description: The site name. Name must be unique
        type: string
        required: true
      description:
        title: Description
        description: The site's description
        type: string
        required: false
      engine_id:
        title: Engine ID
        description: The identifier of a scan engine. Default scan engine is selected
          when not specified
        type: integer
        required: false
      importance:
        title: Importance
        description: The site importance
        type: string
        required: false
        enum:
        - very_low
        - low
        - normal
        - high
        - very_high
        default: normal
      scan_template_id:
        title: Scan Template ID
        description: The identifier of a scan template
        type: string
        required: false
      included_addresses:
        title: Included Addresses
        description: List of addresses to include in scan scope
        type: '[]string'
        default: []
        required: false
      excluded_addresses:
        title: Excluded Addresses
        description: List of addresses to exclude in scan scope
        type: '[]string'
        default: []
        required: false
      included_asset_groups:
        title: Included Asset Groups
        description: Assets associated with these asset group IDs will be included
          in the site
        type: '[]integer'
        default: []
        required: false
      excluded_asset_groups:
        title: Excluded Asset Groups
        description: Assets associated with these asset group IDs will be excluded
          in the site
        type: '[]integer'
        default: []
        required: false
    output:
      id:
        title: ID
        description: The identifier of the created site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site:
    title: Update Site
    description: Update an existing site
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
      name:
        title: Name
        description: The site name. Name must be unique
        type: string
        required: true
      description:
        title: Description
        description: The site's description
        type: string
        required: true
      engine_id:
        title: Engine ID
        description: The identifier of a scan engine. Default scan engine is selected
          when not specified
        type: integer
        required: true
      importance:
        title: Importance
        description: The site importance
        type: string
        required: true
        enum:
        - very_low
        - low
        - normal
        - high
        - very_high
        default: normal
      scan_template_id:
        title: Scan Template ID
        description: The identifier of a scan template
        type: string
        required: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_included_targets:
    title: Update Site Included Targets
    description: Update an existing site scope of included IP address and hostname
      targets
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
      included_targets:
        title: Included Targets
        description: List of addresses that represent either a hostname, IPv4 address,
          IPv4 address range, IPv6 address, or CIDR notation
        type: '[]string'
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the included targets to the current site
          or append to the previous list of included targets
        type: boolean
        required: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_excluded_targets:
    title: Update Site Excluded Targets
    description: Update an existing site scope of excluded IP address and hostname
      targets
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
      excluded_targets:
        title: Excluded Targets
        description: List of addresses that represent either a hostname, IPv4 address,
          IPv4 address range, IPv6 address, or CIDR notation
        type: '[]string'
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the excluded targets to the current site
          or append to the previous list of excluded targets
        type: boolean
        required: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_included_asset_groups:
    title: Update Site Included Asset Groups
    description: Update an existing site scope of included asset groups
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
      included_asset_groups:
        title: Included Asset Group IDs
        description: Assets associated with these asset group IDs will be included
          in the site
        type: '[]integer'
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the included asset group IDs to the current
          site or append to the previous list of asset group IDs
        type: boolean
        required: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_excluded_asset_groups:
    title: Update Site Excluded Asset Groups
    description: Update an existing site scope of excluded asset groups
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
      excluded_asset_groups:
        title: Excluded Asset Group IDs
        description: Assets associated with these asset group IDs will be excluded
          from the site
        type: '[]integer'
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the excluded asset group IDs to the current
          site or append to the previous list of asset group IDs
        type: boolean
        required: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_site:
    title: Delete Site
    description: Delete an existing site
    input:
      id:
        title: ID
        description: Site ID
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_asset_groups:
    title: Get Asset Groups
    description: Get a list of asset groups
    input:
      name:
        title: Name
        description: Asset group name regular expression by which to filter
        type: string
        default: ''
        required: false
    output:
      asset_groups:
        title: Asset Groups
        description: List of asset groups
        type: '[]asset_group'
        required: true
  get_asset_group:
    title: Get Asset Group
    description: Get an asset group by ID
    input:
      id:
        title: ID
        description: Asset group ID
        type: integer
        required: true
    output:
      asset_group:
        title: Asset Group
        description: Asset group
        type: asset_group
        required: true
  create_asset_group:
    title: Create Asset Group
    description: Create an asset group
    input:
      name:
        title: Name
        description: Asset group name
        type: string
        required: true
      description:
        title: Description
        description: Asset group description
        type: string
        required: false
      searchCriteria:
        title: Search Criteria
        description: 'Asset group search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria'
        type: object
        required: false
      type:
        title: Type
        description: Asset group type
        type: string
        required: true
        enum:
        - dynamic
        - static
    output:
      id:
        title: ID
        description: ID of the created tag
        type: integer
        required: true
  delete_asset_group:
    title: Delete Asset Group
    description: Delete an existing asset group
    input:
      id:
        title: ID
        description: Asset group ID
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_asset_group_search_criteria:
    title: Update Asset Group Search Criteria
    description: Update the search criteria for an existing asset group
    input:
      id:
        title: ID
        description: Asset group ID
        type: integer
        required: true
      searchCriteria:
        title: Search Criteria
        description: 'Asset group search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria'
        type: object
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_vulnerabilities_by_cve:
    title: Get Vulnerabilities by CVE
    description: Get vulnerability details associated with a CVE
    input:
      cve_id:
        title: CVE ID
        description: Common Vulnerabilities and Exposures ID, e.g. CVE-2018-12345
        type: string
        required: true
    output:
      vulnerabilities:
        title: Vulnerabilities
        description: Vulnerability details
        type: '[]vulnerability'
        required: true
  get_scans:
    title: Get Scans
    description: Get scans with optional site filter
    input:
      id:
        title: ID
        description: Site ID
        type: integer
        required: false
      active:
        title: Active
        description: Return running scans or past scans
        default: false
        type: boolean
        required: false
    output:
      scans:
        title: Scans
        description: List of scan details
        type: '[]scan'
        required: true
  update_scan_status:
    title: Update Scan Status
    description: Update the status of a scan
    input:
      id:
        title: ID
        description: Scan ID
        type: integer
        required: true
      status:
        title: Status
        description: Status to which the scan should be set (stop, resume, pause)
        type: string
        required: true
        default: stop
        enum:
        - stop
        - resume
        - pause
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  generate_shared_secret:
    title: Generate Shared Secret
    description: Generate a shared secret to pair a scan engine to a security console
    input:
      time_to_live:
        title: Time to Live
        description: Time to live in seconds for the shared secret
        default: 3600
        type: integer
        required: true
    output:
      shared_secret:
        title: Shared Secret
        description: Scan engine pairing shared secret
        type: string
        required: true
  get_scan_engines:
    title: Get Scan Engines
    description: List scan engines paired with the security console
    input:
      name:
        title: Name
        description: Optional engine name by which to filter, accepts regular expression
          patterns
        type: string
        required: false
      address:
        title: Address
        description: Optional address (IP/hostname) by which to filter, accepts regular
          expression patterns
        type: string
        required: false
    output:
      scan_engines:
        title: Scan Engines
        description: List of scan engines details
        type: '[]scan_engine'
        required: true
  get_scan_engine:
    title: Get Scan Engine
    description: Get a scan engine by ID
    input:
      id:
        title: ID
        description: Scan engine identifier
        type: integer
        required: true
    output:
      scan_engine:
        title: Scan Engine
        description: Scan engine details
        type: scan_engine
        required: true
  create_scan_engine:
    title: Create Scan Engine
    description: Create a new scan engine with console engine connectivity
    input:
      name:
        title: Name
        description: Scan engine name
        type: string
        required: true
      address:
        title: Address
        description: Scan engine address (IP/hostname)
        type: string
        required: true
      port:
        title: Port
        description: Scan engine connectivity port
        default: 40814
        type: integer
        required: true
      sites:
        title: Sites
        description: List of site IDs with which to associate the engine
        type: '[]integer'
        default: []
        required: false
    output:
      id:
        title: ID
        description: Scan engine ID
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_scan_engine:
    title: Delete Scan Engine
    description: Delete an existing scan engine from the security console
    input:
      id:
        title: ID
        description: Scan engine identifier
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_scan_engine_pools:
    title: Get Scan Engine Pools
    description: Retrieve a list of configured scan engine pools
    input:
      name:
        title: Name
        description: Scan engine pool name by which to filter, accepts regular expression
          patterns
        type: string
        required: false
    output:
      scan_engine_pools:
        title: Scan Engine Pools
        description: List of scan engine pool details
        type: '[]scan_engine_pool'
        required: true
  get_scan_engine_pool:
    title: Get Scan Engine Pool
    description: Retrieve scan engine pool details by ID
    input:
      id:
        title: ID
        description: Scan engine pool identifier
        type: integer
        required: true
    output:
      scan_engine_pool:
        title: Scan Engine Pool
        description: Scan engine pool details
        type: scan_engine_pool
        required: true
  create_scan_engine_pool:
    title: Create Scan Engine Pool
    description: Create a new scan engine pool
    input:
      name:
        title: Name
        description: Scan engine pool name
        type: string
        required: true
      engines:
        title: Engines
        description: List of scan engine IDs to associate with the scan engine pool
        type: '[]integer'
        required: false
    output:
      id:
        title: ID
        description: Scan engine pool ID
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  add_scan_engine_pool_engine:
    title: Add Scan Engine Pool Engine
    description: Add a scan engine to a scan engine pool (AWS pre-authorized engine
      AMI engines cannot be pooled)
    input:
      pool_id:
        title: Pool ID
        description: Scan engine pool ID
        type: integer
        required: true
      engine_id:
        title: Engine ID
        description: Scan engine ID
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_scan_engine_pool_engine:
    title: Remove Scan Engine Pool Engine
    description: Remove a scan engine from a scan engine pool
    input:
      pool_id:
        title: Pool ID
        description: Scan engine pool ID
        type: integer
        required: true
      engine_id:
        title: Engine ID
        description: Scan engine ID
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_scan_engine_pool:
    title: Delete Scan Engine Pool
    description: Delete an existing scan engine pool from the security console
    input:
      id:
        title: ID
        description: Scan engine pool identifier
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_scan_engine:
    title: Update Site Scan Engine
    description: Update the scan engine/scan engine pool associated with a site
    input:
      site_id:
        title: Site ID
        description: Identifier of the site to update
        type: integer
        required: true
      engine_id:
        title: Engine ID
        description: Identifier of the scan engine/scan engine pool to associate with
          the site
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_authentication_sources:
    title: Get Authentication Sources
    description: List authentication sources available for InsightVM users
    input:
      name:
        title: Name
        description: Authentication source name by which to filter, accepts regular
          expression patterns
        type: string
        required: false
      type:
        title: Type
        description: Authentication source type by which to filter
        type: string
        required: false
        default: ''
        enum:
        - ''
        - admin
        - kerberos
        - ldap
        - normal
        - saml
    output:
      authentication_sources:
        title: Authentication Sources
        description: List of authentication sources
        type: '[]authentication_source'
        required: true
  get_authentication_source:
    title: Get Authentication Source
    description: Get the details for an authentication source
    input:
      id:
        title: ID
        description: Authentication source ID
        type: integer
        required: true
    output:
      authentication_source:
        title: Authentication Source
        description: User authentication source
        type: authentication_source
        required: true
  get_roles:
    title: Get Roles
    description: List role details
    input:
      name:
        title: Name
        description: Role name by which to filter, accepts regular expression patterns
        type: string
        required: false
    output:
      roles:
        title: Roles
        description: List of roles
        type: '[]role'
        required: true
  get_role:
    title: Get Role
    description: Get role details by ID
    input:
      id:
        title: ID
        description: Role ID, e.g 'global-admin'
        type: string
        required: true
    output:
      role:
        title: Role
        description: Role details
        type: role
        required: true
  get_users:
    title: Get Users
    description: List user accounts
    input:
      name:
        title: Name
        description: User account name by which to filter, accepts regular expression
          patterns
        type: string
        required: false
      login:
        title: Login
        description: User account login name by which to filter, accepts regular expression
          patterns
        type: string
        required: false
    output:
      users:
        title: Users
        description: List of user account details
        type: '[]user_account'
        required: true
  get_user:
    title: Get User
    description: Get user account details by ID
    input:
      id:
        title: ID
        description: User account ID
        type: integer
        required: true
    output:
      user:
        title: User
        description: User account details
        type: user_account
        required: true
  create_user:
    title: Create User
    description: Create a new user account (limited to external authentication sources)
    input:
      authentication_id:
        title: Authentication ID
        description: The identifier of the authentication source to use to authenticate
          the user. The source with the specified identifier must be of the type specified
          by Authentication Type. If Authentication ID is omitted, then one source
          of the specified Authentication Type is selected
        type: integer
        required: false
      authentication_type:
        title: Authentication Type
        description: The type of the authentication source to use to authenticate
          the user
        type: string
        required: true
        default: ldap
        enum:
        - kerberos
        - ldap
        - saml
      email:
        title: Email
        description: The email address of the user
        type: string
        required: true
      enabled:
        title: Enabled
        description: Whether the user account is enabled
        type: boolean
        required: true
        default: true
      login:
        title: Login
        description: The login name of the user
        type: string
        required: true
      name:
        title: Name
        description: The full name of the user
        type: string
        required: true
      access_all_asset_groups:
        title: Access All Asset Groups
        description: Whether to grant the user access to all asset groups
        type: boolean
        required: true
        default: false
      access_all_sites:
        title: Access All Sites
        description: Whether to grant the user access to all sites
        type: boolean
        required: true
        default: false
      role_id:
        title: Role ID
        description: The identifier of the role to which the user should be assigned,
          e.g 'global-admin'
        type: string
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
      id:
        title: ID
        description: The identifier of the created user account
        type: integer
        required: true
  update_user:
    title: Update User
    description: Update the configuration of an existing user account
    input:
      id:
        title: ID
        description: The identifier of the user
        type: integer
        required: true
      authentication_id:
        title: Authentication ID
        description: The identifier of the authentication source to use to authenticate
          the user. The source with the specified identifier must be of the type specified
          by Authentication Type. If Authentication ID is omitted, then one source
          of the specified Authentication Type is selected
        type: integer
        required: false
      authentication_type:
        title: Authentication Type
        description: The type of the authentication source to use to authenticate
          the user
        type: string
        required: true
        default: ldap
        enum:
        - normal
        - admin
        - kerberos
        - ldap
        - saml
      email:
        title: Email
        description: The email address of the user
        type: string
        required: true
      enabled:
        title: Enabled
        description: Whether the user account is enabled
        type: boolean
        required: true
        default: true
      login:
        title: Login
        description: The login name of the user
        type: string
        required: true
      name:
        title: Name
        description: The full name of the user
        type: string
        required: true
      access_all_asset_groups:
        title: Access All Asset Groups
        description: Whether to grant the user access to all asset groups
        type: boolean
        required: true
        default: false
      access_all_sites:
        title: Access All Sites
        description: Whether to grant the user access to all sites
        type: boolean
        required: true
        default: false
      role_id:
        title: Role ID
        description: The identifier of the role to which the user should be assigned,
          e.g 'global-admin'
        type: string
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_user:
    title: Delete User
    description: Delete an user account
    input:
      id:
        title: ID
        description: The identifier of the user account
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  disable_user:
    title: Disable User
    description: Disable an user account
    input:
      id:
        title: ID
        description: The identifier of the user account
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  enable_user:
    title: Enable User
    description: Enable an user account
    input:
      id:
        title: ID
        description: The identifier of the user account
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_user_role:
    title: Update User Role
    description: Update the role associated with an user account
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      access_all_asset_groups:
        title: Access All Asset Groups
        description: Whether to grant the user access to all asset groups
        type: boolean
        required: true
        default: false
      access_all_sites:
        title: Access All Sites
        description: Whether to grant the user access to all sites
        type: boolean
        required: true
        default: false
      role_id:
        title: Role ID
        description: The identifier of the role to which the user should be assigned,
          e.g 'global-admin'
        type: string
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_user_asset_group_access:
    title: Update User Asset Group Access
    description: Update the asset groups to which a user has access in bulk. It can
      be used to remove asset group access as well
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      asset_group_ids:
        title: Asset Group IDs
        description: The identifiers of the asset groups to which the user account
          should be granted access, ignored if the user has access to all asset groups
        type: '[]integer'
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  add_user_asset_group_access:
    title: Add User Asset Group Access
    description: Grant an user account access to an asset group by ID
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      asset_group_id:
        title: Asset Group ID
        description: The identifier of the asset group
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_user_asset_group_access:
    title: Remove User Asset Group Access
    description: Remove asset group access from an user account
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      asset_group_id:
        title: Asset Group ID
        description: The identifier of the asset group
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_user_site_access:
    title: Update User Site Access
    description: Update the sites to which a user has access in bulk. It can be used
      to remove sites as well
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      site_ids:
        title: Site IDs
        description: The identifiers of the sites to which the user account should
          be granted access, ignored if the user has access to all sites
        type: '[]integer'
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  add_user_site_access:
    title: Add User Site Access
    description: Grant an user account access to a site by ID
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      site_id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_user_site_access:
    title: Remove User Site Access
    description: Remove site access from an user account
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        required: true
      site_id:
        title: Site ID
        description: The identifier of the site
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  top_remediations:
    title: Top Remediations
    description: Generate results for the top remediations based on a defined scope
    input:
      limit:
        title: Limit
        description: Number of remediations for which tickets should be generated
        type: integer
        required: true
        default: 25
        enum:
          - 10
          - 25
          - 50
          - 100
      scope:
        title: Scope
        description: Scope context for generated report; if set remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID
        type: string
        required: true
        default: none
        enum:
          - none
          - assets
          - assetGroups
          - sites
          - tags
          - scan
      scope_ids:
        title: Scope IDs
        description: Scope IDs for which tickets should be generated, by default all are included
        type: '[]integer'
        required: false
        default: []
      asset_limit:
        title: Asset Limit
        description: The amount of assets to be returned with each top remediation; this can be used to reduce message size and processing time
        type: integer
        required: false
      vulnerability_limit:
        title: Vulnerability Limit
        description: The amount of vulnerabilities to be returned with each top remediation; this can be used to reduce message size and processing time
        type: integer
        required: false
    output:
      remediations:
        title: Remediations
        description: List of top remediations
        type: '[]remediation'
        required: true
  generate_adhoc_sql_report:
    title: Generate AdHoc SQL Report
    description: Create, generate, download, and cleanup a SQL report based on the provided query
    input:
      query:
        title: Query
        type: string
        description: Reporting Data Model SQL query
        required: true
      scope:
        title: Scope
        description: Scope context for generated report; if set, remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID; scan scope only supports single scan ID as input
        type: string
        required: true
        default: none
        enum:
          - none
          - assets
          - assetGroups
          - sites
          - tags
          - scan
      scope_ids:
        title: Scope IDs
        description: Scope IDs for which tickets should be generated, by default all are included
        type: '[]integer'
        required: false
        default: []
      filters:
        title: Report Filters
        description: Filters in JSON format to be applied to the contents of the report; review InsightVM API documentation for filter options
        type: string
        required: false
        default: '{}'
    output:
      report:
        type: file
        title: Base64 Encoded Report
        description: Base64 encoded file making up the report
        required: true
  review_exception:
    title: Review Vulnerability Exception
    description: Approve or Reject a Vulnerability Exception
    input:
      exception:
        title: Exception ID
        description: The vulnerability exception ID to approve or reject
        type: integer
        required: true
      review:
        title: Review Outcome
        description: Approval or rejection of the exception
        type: string
        required: true
        enum:
        - Approved
        - Rejected
      comment:
        title: Review Comment
        description: Comment to include in the review
        type: string
        required: false
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_exception:
    title: Delete Vulnerability Exception
    description: Delete an existing vulnerability exception
    input:
      exception_id:
        title: Exception ID
        description: Vulnerability exception ID to delete
        type: integer
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  create_exception:
    title: Create Vulnerability Exception Submission
    description: Create a vulnerability exception submission
    input:
      type:
        title: Exception Type
        description: The type of vulnerability exception to create
        type: string
        required: true
        enum:
        - Global
        - Site
        - Asset
        - Asset Group
        - Instance
      vulnerability:
        title: Vulnerability
        description: The vulnerability this exception applies to
        type: string
        required: true
      scope:
        title: Scope ID
        description: The ID of the scope the vulnerability exception applies to.  May be empty if type is Global
        type: integer
        required: false
      expiration:
        title: Expiration
        description: The date the vulnerability exception expires
        type: date
        required: false
      comment:
        title: Comment
        description: Comment to include in the vulnerability exception submission
        type: string
        required: true
        default: Exception created with InsightConnect
      reason:
        title: Reason
        description: Reason for the exception
        type: string
        required: true
        enum:
        - False Positive
        - Compensating Control
        - Acceptable Use
        - Acceptable Risk
        - Other
      key:
        title: Vulnerability Key
        description: The key to identify a specific instance if the type is Instance
        type: string
        required: false
      port:
        title: Vulnerability Port
        description: The port the vulnerability appears on if the type is Instance
        type: integer
        required: false
    output:
      id:
        title: Created Exception ID
        description: The vulnerability exception that was created
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_vulnerability:
    title: Get Vulnerability Details
    description: Get the details of a specific vulnerability by id
    input:
      id:
        title: Vulnerability ID
        description: The identifier of the vulnerability to retrieve from InsightVM
        type: string
        required: true
    output:
      vulnerability:
        title: Vulnerability Details
        description: The details of the vulnerability requested
        type: vulnerability
        required: true
triggers:
  new_scans:
    title: New Scans
    description: Check for new InsightVM scans by site and scan status
    input:
      frequency:
        title: Frequency
        description: How often the trigger should check for new scans in minutes
        type: integer
        required: true
        default: 5
      site_name_filter:
        title: Site Name Filter
        description: Regular expression to match sites where new scans should be triggered
        type: string
        required: true
        default: .*
      most_recent_scan:
        title: Most Recent Scan Only
        description: Only process the most recent scan for a site since the last time the trigger was run
        type: boolean
        required: true
        default: true
      status_filter:
        title: Status Filter
        description: 'List of scan statuses to match for trigger; options include: Aborted, Successful, Running, Stopped, Failed, Paused, Unknown'
        type: '[]string'
        required: false
        default: ['Successful']
    output:
      scan:
        title: Scan
        description: InsightVM Scan
        type: scan
        required: false
  new_exception_request:
    title: New Vulnerability Exception
    description: Check for new InsightVM vulnerability exceptions
    input:
      frequency:
        title: Frequency
        description: How often the trigger should check for new vulnerability exception requests
        type: integer
        required: true
        default: 5
      status_filter:
        title: Status Filter
        description: 'List of vulnerability statuses to match against. Options include: Under Review and Approved'
        type: '[]string'
        required: false
        default: ['Under Review']
    output:
      exception:
        title: Vulnerability Exception
        description: InsightVM vulnerability exception
        type: vulnerability_exception
        required: false
