plugin_spec_version: v2
extension: plugin
product: ["insightconnect"]
name: cisco_umbrella_investigate
title: Cisco Umbrella Investigate
vendor: rapid7
support: rapid7
status: []
description: Cisco Umbrella Investigate provides the most complete view of the relationships
  and evolution of Internet domains, IP addresses, and autonomous systems to pinpoint
  attackers infrastructures and predict future threats
version: 1.0.2
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/cisco_umbrella_investigate
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
tags:
        title: Domain Tags
        description: Date range for which this domain has been in the block list,
          domain tag such as malware or phishing, identifying the security category
          of the domain, if available or possible, list the specific URL hosting the
          malicious content
        type: '[]tag_date'
        required: true
  rr_history:
    title: DNS RR History
    description: Return the history that Umbrella has seen for a given domain
    input:
      type:
        title: DNS Record
        type: string
        description: DNS record query type (A, NS, MX, TXT and CNAME are supported)
        required: false
      domain:
        type: string
        description: Domain name
        required: true
    output:
      rrs_tf:
        title: Resource Records
        description: RRS TF
        type: '[]resource_record'
        required: true
      features:
        title: Features
        description: Features
        type: '[]feature'
        required: true
  rr_history_ip:
    title: DNS RR History for IP Address
    description: Return the history that Umbrella has seen for a given IP address
    input:
      type:
        title: DNS Record Type
        type: string
        description: DNS record query type (A, NS, MX, TXT and CNAME are supported)
        required: false
      IP:
        title: IP Address
        type: string
        description: IP address
        required: true
    output:
      rrs:
        title: Resource Records
        type: '[]ip_resource_record'
        description: RRS
        required: true
      features:
        title: Features
        description: Features
        type: '[]ip_feature'
        required: true
  email_whois:
    title: WHOIS Information by Email
    description: Returns the WHOIS information for the specified email address(es),
      nameserver(s) and domains
    input:
      email:
        title: Email
        type: string
        description: Email address following rfc5322 conventions
        required: true
    output:
      email_whois:
        title: Email WHOIS
        description: Domains registered by this email address
        type: '[]email_whois'
        required: true
  domain_whois:
    title: WHOIS by Domain
    description: A standard WHOIS response record for a single domain with all available
      WHOIS data returned in an array
    input:
      domain:
        type: string
        description: Domain name without wildcards and including TLD
        required: true
    output:
      whois:
        title: WHOIS
        description: Array of WHOIS results for the domain provided with all available
          information
        type: array
        required: true
  ns_whois:
    title: WHOIS by Nameserver
    description: Allows you to search a nameserver to find all domains registered
      by that nameserver
    input:
      nameserver:
        title: Nameserver Domain
        type: string
        description: Nameserver's domain name
        required: true
    output:
      domain:
        description: Array of WHOIS results for the domain provided with all available
          information
        type: '[]email_whois'
        required: true
  search:
    title: Pattern Search
    description: The pattern search functionality in Investigate uses regular expressions
      (RegEx) to search against the Investigate database
    input:
      expression:
        type: string
        description: A standard RegEx pattern search
        required: true
      start:
        type: string
        description: If specifying in absolute, use millisecond timestamp within the
          last 30 days as the Start. If specifying in relative, use either seconds,
          minutes, hours, days or weeks with a minus sign in front. As an example
          -1days, -1000minutes
        required: true
      include_category:
        title: Include Category
        type: boolean
        description: Default is false, if set to true this will include security categories
          in the results and may slow the return times
        required: false
      limit:
        title: Request Limit
        type: integer
        description: Default is 1000, limit request response
        required: false
    output:
      expression:
        description: This is the RegEx in the query as seen from the API. If results
          from your query do not match what you may have expected, check to see that
          the RegEx matches the one you tried to enter and that characters are correctly
          escaped in the query string
        type: string
        required: true
      totalResults:
        title: Total Results
        description: Total results from this search string. The default number of
          results is 100 and can be expanded using the limit parameter
        type: integer
        required: true
      moreDataAvailable:
        title: More Data Available
        description: Whether more data is available than what is displayed. Will be
          true if totalResults exceed limit. We recommend refining your filter if
          this value is true
        type: boolean
        required: true
      limit:
        description: Default is 100, can be expanded to 1000 which is the maximum
          number of results for this endpoint
        type: integer
        required: true
      matches:
        description: 'Each match will contain the name of the domain matches, the
          and the first seen time, both in Epoch and ISO time format. This endpoint
          returns the security categories as strings rather than integers (eg: ''malware'',''botnet'',
          etc) if includeCategory is true'
        type: array
        required: true
  latest_domains:
    title: Latest Malicious Domains by IP
    description: Return associated malicious domains for an IP address
    input:
      IP:
        title: IP Address
        type: string
        description: IP Address to check for malicious domains
        required: true
    output:
      domains:
        description: The block list domain associated with the IP
        type: '[]string'
        required: true
  samples:
    title: Samples by Domain
    description: Return all samples associated with the domain
    input:
      URL:
        title: URL
        type: string
        description: Search sample by domain, IP or URL
        required: true
      limit:
        type: string
        description: The number of responses; default of 10 as a limit on response,
          can be extended
        required: false
      offset:
        type: string
        description: Default to 0, used to pagination between sets of data if limit
          is exceeded
        required: false
      sortby:
        title: Sort By
        type: string
        description: Default is score. Choose from ['first-seen', 'last-seen', 'score'].
          'first-seen' sorts the samples in date descending order. 'last-seen' sorts
          the samples in ascending order. 'score' sorts the samples by the ThreatScore
        required: false
    output:
      query:
        title: Query
        description: What string was queried or seen by the API
        type: string
        required: true
      totalResults:
        title: Total Results
        description: The number of results returned. Same as limit if limit is reached
          and moreDataAvailable is true
        type: integer
        required: true
      moreDataAvailable:
        title: More Data Available
        description: If more data is available. Extend the limit and/or offset to
          view
        type: boolean
        required: true
      limit:
        description: Number of sample results
        type: integer
        required: true
      offset:
        description: The offset of the individual entities in the query’s response;
          used for pagination
        type: integer
        required: true
      samples:
        description: Information about the actual sample
        type: '[]sample_info'
        required: true
  sample:
    title: File Sample
    description: Return a file, or a file-like object, such as a process running in
      memory
    input:
      hash:
        type: string
        description: Search sample by hash (SHA-256, SHA-1 or MD5)
        required: true
      limit:
        type: string
        description: Default of 10, can be extended for a larger data set
        required: false
      offset:
        type: string
        description: The offset of the individual entities in the query’s response,
          used for pagination
        required: false
    output:
      sample:
        title: Sample
        description: Sample
        type: sample_info
        required: false
  sample_artifacts:
    title: Sample Artifacts
    description: Return artifacts which are files created or modified during a sample
      analysis
    input:
      hash:
        type: string
        description: Search sample by hash (SHA-256, SHA-1 or MD5)
        required: true
      limit:
        type: string
        description: Default of 10, can be extended for a larger data set
        required: false
      offset:
        type: string
        description: Used to paginate between sets of data
        required: false
    output:
      artifacts:
        title: Artifacts
        description: Artifacts
        type: array
        required: true
  sample_connections:
    title: Sample Connections
    description: Return network activity information associated with a sample
    input:
      hash:
        type: string
        description: Search sample by hash (SHA-256, SHA-1 or MD5)
        required: true
      limit:
        type: string
        description: Default of 10, can be extended for a larger data set
        required: false
      offset:
        type: string
        description: Used to paginate between sets of data
        required: false
    output:
      connections:
        title: Connections
        type: array
        description: Connections
        required: true
  sample_samples:
    title: Other Samples
    description: Return other samples associated with a sample
    input:
      hash:
        type: string
        description: Search sample by hash (SHA-256, SHA-1 or MD5)
        required: true
      limit:
        type: string
        description: Default of 10, can be extended for a larger data set
        required: false
      offset:
        type: string
        description: Used to paginate between sets of data
        required: false
    output:
      samples:
        title: Samples
        description: Samples
        type: array
        required: true
